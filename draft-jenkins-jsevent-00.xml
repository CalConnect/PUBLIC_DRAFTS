<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM 'rfc2629.dtd' []>
<rfc ipr="trust200902" category="std" docName="draft-jenkins-jsevent-00">
<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc private=""?>
<?rfc topblock="yes"?>
<?rfc comments="no"?>
<front>
<title abbrev="JSEvent">JSEvent: A better JSON representation of calendar event data</title>

<author initials="N.M." surname="Jenkins" fullname="Neil Jenkins">
<organization>FastMail</organization>
<address>
<postal>
<street>Level 1, 91 William St</street>
<city>Melbourne</city>
<code>VIC 3000</code>
<country>Australia</country>
<region></region>
</postal>
<phone></phone>
<email>neilj@fastmail.com</email>
<uri>https://www.fastmail.com</uri>
</address>
</author>
<date year="2016" month="October" day="27"/>

<area>Applications</area>
<workgroup>JSON data formats for vCard and iCalendar</workgroup>
<keyword>JSON</keyword>
<keyword>iCalendar</keyword>
<keyword>calendar</keyword>
<keyword>events</keyword>
<keyword>date</keyword>
<keyword>time</keyword>


<abstract>
<t>This specification defines a JSON representation of calendar event data that can be used for storage and data exchange in a calendaring and scheduling environment. JSON is a lightweight, text-based, language-independent data interchange format commonly used in Internet applications.
</t>
</abstract>


</front>

<middle>

<section anchor="introduction" title="Introduction">
<t>The iCalendar data format <xref target="RFC5545"/>, a widely deployed interchange format for calendaring and scheduling data, has served calendaring vendors for a long while, but contains some ambiguities in its data model that can not be overcome without backwards incompatible changes.
</t>
<t>JSON is a text-based data interchange format as specified in <xref target="RFC7159"/>. The I-JSON format defined in <xref target="RFC7493"/> is a strict subset of this, adding restrictions to avoid potentially confusing scenarios (for example, it mandates that an object MUST NOT have two properties with the same key).
</t>
<t>This document defines a JSON-based format describing a single event within a calendar, using a new data model that aims to be unambigous, extendable and simple to process.
</t>
<t>The key design considerations for this format are as follows:
</t>
<t>
<list style="symbols">
<t>The attributes of the event represented must be described as a simple key-value pair, reducing complexity of the event representation.</t>
<t>The data format should avoid all ambiguities, making it difficult to make mistakes during implementation and increasing interoperability.</t>
<t>The initial set of attributes should be taken from the iCalendar data format, but a conversion between the data formats is not guaranteed to be completed without losing semantic meaning.</t>
<t>Extensions, such as new properties and components, must not lead to requiring an update to this document.</t>
</list>
</t>

<section anchor="notational-conventions" title="Notational Conventions">
<t>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be interpreted as described in <xref target="RFC2119"/>.
</t>
<t>The underlying format used for this specification is JSON. Consequently, the terms &quot;object&quot; and &quot;array&quot; as well as the four primitive types (strings, numbers, booleans, and null) are to be interpreted as described in Section 1 of <xref target="RFC7159"/>.
</t>
<t>Some examples in this document contain &quot;partial&quot; JSON documents used for illustrative purposes.  In these examples, three periods &quot;...&quot; are used to indicate a portion of the document that has been removed for compactness.
</t>
</section>

<section anchor="data-types" title="Data Types">
<t>In addition to the standard JSON data types, the following data types are used in this specification:
</t>

<section anchor="utcdate" title="UTCDate">
<t>This is a string in <xref target="RFC3339"/> <spanx style="verb">date-time</spanx> format, with the further restrictions that any letters MUST be in upper-case, the time component MUST be included and the time MUST be in UTC. Fractional second values MUST NOT be included unless non-zero (so, for example <spanx style="verb">2010-10-10T10:10:10.003Z</spanx> is OK, but <spanx style="verb">2010-10-10T10:10:10.000Z</spanx> is invalid and MUST be encoded as <spanx style="verb">2010-10-10T10:10:10Z</spanx>).
</t>
<t>In common notation, it should be of the form <spanx style="verb">YYYY-MM-DDTHH:MM:SSZ</spanx>.
</t>
</section>

<section anchor="localdate" title="LocalDate">
<t>This is a date-time string with <spanx style="strong">no time zone/offset information attached</spanx>. It is otherwise in the same format as UTCDate: <spanx style="verb">YYYY-MM-DDTHH:MM:SS</spanx>. The time zone to associate with this comes from an associated property.
</t>
</section>

<section anchor="duration" title="Duration">
<t>A duration is represented by a subset of ISO8601 duration format, as specified by the following ABNF:
</t>
<t>dur-secfrac       = &quot;.&quot; 1<spanx style="emph">DIGIT
   dur-second        = 1</spanx>DIGIT [dur-secfrac] &quot;S&quot;
   dur-minute        = 1<spanx style="emph">DIGIT &quot;M&quot; [dur-second]
   dur-hour          = 1</spanx>DIGIT &quot;H&quot; [dur-minute]
   dur-time          = &quot;T&quot; (dur-hour / dur-minute / dur-second)
   dur-day           = 1*DIGIT &quot;D&quot;
</t>
<t>duration          = &quot;P&quot; (dur-day [dur-time] / dur-time)
</t>
<t>In addition, the duration MUST NOT include fractional second values unless the fraction is non-zero.
</t>
</section>
</section>

<section anchor="type-signatures" title="Type signatures">
<t>Types signatures are given for all JSON objects in this document. The following conventions are used:
</t>
<t>
<list style="symbols">
<t><spanx style="verb">Boolean|String</spanx> – The value is either a JSON <spanx style="verb">Boolean</spanx> value, or a JSON <spanx style="verb">String</spanx> value.</t>
<t><spanx style="verb">Foo</spanx> – Any name that is not a native JSON type means an object for which the properties (and their types) are defined elsewhere within this document.</t>
<t><spanx style="verb">Foo[]</spanx> – An array of objects of type <spanx style="verb">Foo</spanx>.</t>
<t><spanx style="verb">String[Foo]</spanx> – A JSON <spanx style="verb">Object</spanx> being used as a map (associative array), where all the values are of type <spanx style="verb">Foo</spanx>.</t>
</list>
</t>
</section>
</section>

<section anchor="structure-of-a-jsevent-object" title="Structure of a JSEvent object">
<t>A JSEvent object is a JSON object, which MUST be valid I-JSON (a stricter subset of JSON), as specified in <xref target="RFC7159"/>. Property names and values are case-sensitive.
</t>
<t>The object has a collection of properties, as specified in the following sections. A valid JSEvent object MUST include <spanx style="strong">uid</spanx>, <spanx style="strong">updated</spanx> and <spanx style="strong">start</spanx> properties. All other properties are optional; omitted properties MUST be treated identically to if that property had the value of <spanx style="verb">null</spanx>, unless otherwise specified.
</t>
<t>Vendors MAY add additional properties to the event object to support their custom features. The names of these properties SHOULD be prefixed with a domain name controlled by the vendor to avoid conflict, e.g. <spanx style="verb">fastmail.com/customprop</spanx>. Other systems that interact with events with properties they do not recognise SHOULD try to preserve them, but MUST otherwise ignore them.
</t>
</section>

<section anchor="metadata-properties" title="Metadata properties">

<section anchor="uid" title="uid">
<t>Type: <spanx style="verb">String</spanx>
</t>
<t>A globally unique identifier, used to associate the event as the same across different systems, calendars and views.
</t>
<t>Corresponds to the UID property in iCalendar.
</t>
</section>

<section anchor="relatedto" title="relatedTo">
<t>Type: <spanx style="verb">String[String]|null</spanx>
</t>
<t>A map of relation-type to the UID of the related event. Specified relation types are:
</t>
<t>
<list style="symbols">
<t><spanx style="verb">first</spanx>: The first event in a series.</t>
<t><spanx style="verb">next</spanx>: The next event in a series.</t>
</list>
</t>
<t>If an event is split to make a &quot;this and future&quot; change to a recurrence, the original event should be truncated to end at the previous occurrence before this split, and a new event created to represent all the events after the split.
</t>
<t>A <spanx style="verb">next</spanx> <spanx style="emph">relatedTo</spanx> property SHOULD be set on the original event with the UID of the new event. A <spanx style="verb">first</spanx> <spanx style="emph">relatedTo</spanx> property with the UID of the first event in the series SHOULD be set on the new event. Clients can then follow these UIDs to get the complete set of events if the user wishes to modify them all at once.
</t>
<t>Corresponds to the RELATED-TO property in iCalendar.
</t>
</section>

<section anchor="prodid" title="prodId">
<t>Type: <spanx style="verb">String|null</spanx>
</t>
<t>The identifier for the product that created the Event object. The vendor of the implementation SHOULD ensure that this is a globally unique identifier.
</t>
<t>Corresponds to the PRODID property in iCalendar.
</t>
</section>

<section anchor="created" title="created">
<t>Type: <spanx style="verb">UTCDate|null</spanx>
</t>
<t>The time this event was created.
</t>
<t>Corresponds to the CREATED property in iCalendar.
</t>
</section>

<section anchor="updated" title="updated">
<t>Type: <spanx style="verb">UTCDate</spanx>
</t>
<t>The time this event was last changed. If part of an iMIP message (i.e. the event has a <spanx style="emph">method</spanx> property), this is when the iMIP message was created.
</t>
<t>Corresponds to the DTSTAMP property in iCalendar.
</t>
</section>

<section anchor="sequence" title="sequence">
<t>Type: <spanx style="verb">Number</spanx> (Defaults to <spanx style="verb">0</spanx> if omitted)
</t>
<t>Initially zero, this is monotonically incremented each time a significant change is made to the event.
</t>
<t>Corresponds to the SEQUENCE property in iCalendar.
</t>
</section>

<section anchor="method" title="method">
<t>Type: <spanx style="verb">String|null</spanx>
</t>
<t>The iTIP method, in lower-case. Used for scheduling.
</t>
<t>Corresponds to the METHOD property in iCalendar.
</t>
</section>
</section>

<section anchor="what-and-where-properties" title="What and where properties">

<section anchor="title" title="title">
<t>Type: <spanx style="verb">String</spanx> (Defaults to <spanx style="verb">''</spanx> (the empty string) if omitted)
</t>
<t>A short summary of the event.
</t>
<t>Corresponds to the SUMMARY property in iCalendar.
</t>
</section>

<section anchor="description" title="description">
<t>Type: <spanx style="verb">String</spanx> (Defaults to <spanx style="verb">''</spanx> (the empty string) if omitted)
</t>
<t>A longer form description of the event. This is plain text, but a client SHOULD attempt to hyperlink URLs when displaying it.
</t>
<t>Corresponds to the DESCRIPTION property in iCalendar.
</t>
</section>

<section anchor="locations" title="locations">
<t>Type: <spanx style="verb">String[Location]|null</spanx>
</t>
<t>A map of of location id to Location objects, representing locations associated with the event. A location id may be any string and need only be unique to this event, although a UUID is a practical choice.
</t>
<t>A <spanx style="strong">Location</spanx> object has the following properties. All properties are optional, but every Location object MUST have at least one property:
</t>
<t>
<list style="symbols">
<t><spanx style="strong">name</spanx>: <spanx style="verb">String</spanx>
The human-readable name of the location.</t>
<t><spanx style="strong">accessInstructions</spanx>: <spanx style="verb">String</spanx>
Human-readable instructions for accessing this location. This may be a set of directions, door access code, etc.</t>
<t><spanx style="strong">rel</spanx>: <spanx style="verb">String</spanx>
The relation type of this location to the event. This MUST be either one of the following values, registered in a future RFC, or a vendor-specific value. Vendor specific values MUST be prefixed with a domain name controlled by the vendor, e.g. <spanx style="verb">fastmail.com/customrel</spanx>. Any value the client or server doesn't understand should be treated the same as <spanx style="verb">unknown</spanx>.
<list style="symbols">
<t><spanx style="verb">start</spanx>: The event starts at this location.</t>
<t><spanx style="verb">end</spanx>: The event ends at this location.</t>
<t><spanx style="verb">virtual</spanx>: This is not a physical location (e.g. this location is an online chat room where people will meet.)</t>
<t><spanx style="verb">unknown</spanx>: The relation of this location to the event is unknown.</t>
</list></t>
<t><spanx style="strong">timeZone</spanx>: <spanx style="verb">String</spanx> (IANA TZ name)
A time zone for this location. If omitted, the event time zone MUST be used for this location.</t>
<t><spanx style="strong">address</spanx>: <spanx style="verb">Address</spanx>
The structured address of this location.
An <spanx style="strong">Address</spanx> object has the following properties. All properties MUST
be included, but may be the empty string:
<list style="symbols">
<t><spanx style="strong">street</spanx>: <spanx style="verb">String</spanx>
The street address. This MAY be multiple lines; newlines MUST be preserved.</t>
<t><spanx style="strong">locality</spanx>: <spanx style="verb">String</spanx>
The city, town, village, post town, or other locality within which the street address may be found.</t>
<t><spanx style="strong">region</spanx>: <spanx style="verb">String</spanx>
The province, such as a state, county, or canton within which the locality may be found.</t>
<t><spanx style="strong">postcode</spanx>: <spanx style="verb">String</spanx>
The postal code, post code, ZIP code or other short code associated with the address by the relevant country's postal system.</t>
<t><spanx style="strong">country</spanx>: <spanx style="verb">String</spanx>
The country name.</t>
</list></t>
<t><spanx style="strong">coordinates</spanx>: <spanx style="verb">String</spanx>
An <xref target="RFC5870"/> <spanx style="verb">geo:</spanx> URI for the location.</t>
<t><spanx style="strong">uri</spanx>: <spanx style="verb">String</spanx>
A URI that represents how to connect to the event from this location. This may be a telephone number (represented as <spanx style="verb">tel:+1-555-555-555</spanx>) for a teleconference, a web address for online chat, or a custom URI for something like Skype (e.g. <spanx style="verb">skype:username</spanx>).</t>
</list>
</t>
<t>Corresponds to the LOCATION property in iCalendar, however this representation is much richer than is supported by iCalendar. When converting from iCalendar, the LOCATION property should become a single location with just a <spanx style="emph">name</spanx> property. If the event has a different end time zone to start time zone, this should be added as a second location with just a <spanx style="emph">timeZone</spanx> property.
</t>
</section>

<section anchor="links" title="links">
<t>Type: <spanx style="verb">String[Link]|null</spanx>
</t>
<t>A map of of link id to Link objects, representing external resources associated with the event. A link id may be any string and need only be unique to this event, although the href or a UUID are practical choices.
</t>
<t>Corresponds to the ATTACH property in iCalendar.
</t>
<t>A <spanx style="strong">Link</spanx> object has the following properties:
</t>
<t>
<list style="symbols">
<t><spanx style="strong">href</spanx>: <spanx style="verb">String</spanx>
A URI from which the resource may be fetched. This MAY be a <spanx style="verb">data:</spanx> URL, but it is recommended that the file be hosted on a server.</t>
<t><spanx style="strong">type</spanx>: <spanx style="verb">String|null</spanx> (optional, defaults to <spanx style="verb">null</spanx>)
The content-type of the resource, if known.</t>
<t><spanx style="strong">size</spanx>: <spanx style="verb">Number|null</spanx> (optional, defaults to <spanx style="verb">null</spanx>)
The size, in bytes, of the resource when fully decoded (i.e. the number of bytes in the file the user would download), if known.</t>
<t><spanx style="strong">rel</spanx>: <spanx style="verb">String</spanx> (optional, defaults to <spanx style="verb">related</spanx>)
The value of the &quot;rel&quot; member is a string that is a <eref target="http://www.iana.org/assignments/link-relations/link-relations.xhtml">registered relation type</eref> (see <xref target="RFC5988"/>). The value identifies the relation of the linked resource to the event.
Links with a <spanx style="emph">rel</spanx> of <spanx style="verb">enclosure</spanx> SHOULD be considered by the client as attachments for download.
Links with a <spanx style="emph">rel</spanx> of <spanx style="verb">describedby</spanx> SHOULD be considered by the client to be an alternate representation of the <spanx style="emph">description</spanx>, for example an HTML page describing the event.</t>
<t><spanx style="strong">title</spanx>: <spanx style="verb">String|null</spanx> (optional, defaults to <spanx style="verb">null</spanx>)
A human-readable description of the resource.</t>
<t><spanx style="strong">properties</spanx>: <spanx style="verb">String[String|null]|null</spanx> (optional, defaults to <spanx style="verb">null</spanx>)
Extra metadata stored by a client about a link. The keys are URIs, which should be owned by the client author to avoid conflicts, and the values are strings or <spanx style="verb">null</spanx>.</t>
</list>
</t>
</section>

<section anchor="locale" title="locale">
<t>Type: <spanx style="verb">String|null</spanx>
</t>
<t>The <xref target="RFC5646"/> language tag that best describes the locale used for the event, if known.
</t>
<t>Corresponds to the LANGUAGE parameter in iCalendar, which is added to individual properties. When converting from iCalendar, one language must be picked as the main <spanx style="emph">locale</spanx> for the event, and all properties in other languages moved to the <spanx style="emph">localizations</spanx> JSEvent property.
</t>
</section>

<section anchor="localizations" title="localizations">
<t>Type: <spanx style="verb">String[PatchObject]|null</spanx>
</t>
<t>A map of <xref target="RFC5646"/> language tag to a patch object which localises the event into that locale.
</t>
<t>See the description of <spanx style="emph">recurrenceOverrides</spanx> for the structure of the PatchObject. The patches are applied to the top-level object. In <spanx style="strong">addition</spanx> to all the restrictions on patches specified there, the pointer also MUST NOT start with one of the following prefixes; any patch with a such a key MUST be ignored:
</t>
<t>
<list style="symbols">
<t><spanx style="verb">sequence</spanx></t>
<t><spanx style="verb">localization</spanx></t>
<t><spanx style="verb">start</spanx></t>
<t><spanx style="verb">timeZone</spanx></t>
<t><spanx style="verb">duration</spanx></t>
<t><spanx style="verb">status</spanx></t>
<t><spanx style="verb">showAsFree</spanx></t>
<t><spanx style="verb">participants</spanx></t>
<t><spanx style="verb">useDefaultAlerts</spanx></t>
</list>
</t>
<t>Corresponds to the LANGUAGE parameter in iCalendar, which is added to individual properties. When converting from iCalendar, one language must be picked as the main <spanx style="emph">locale</spanx> for the event, and all properties in other languages moved to the <spanx style="emph">localizations</spanx> JSEvent property.
</t>
</section>
</section>

<section anchor="time-duration-and-recurrence-properties" title="Time, duration and recurrence properties">

<section anchor="isallday" title="isAllDay">
<t>Type: <spanx style="verb">Boolean</spanx> (optional, defaults to <spanx style="verb">false</spanx>)
</t>
<t>Is the event an all day event, such as a birthday or public holiday?
</t>
<t>Corresponds to the type (DATE or DATE-TIME) of the DTSTART property in iCalendar.
</t>
</section>

<section anchor="start" title="start">
<t>Type: <spanx style="verb">LocalDate</spanx> e.g. <spanx style="verb">2015-09-02T00:00:00</spanx>
</t>
<t>The date/time the event would start in the event's time zone.
</t>
<t>Corresponds to the DTSTART property in iCalendar. Note that time zone information is stored separately in JSEvent.
</t>
</section>

<section anchor="timezone" title="timeZone">
<t>Type: <spanx style="verb">String|null</spanx>
</t>
<t>The <eref target="http://www.iana.org/time-zones">IANA Time Zone Database</eref> name for the time zone the event is scheduled in, or <spanx style="verb">null</spanx> for floating time. If omitted, this MUST be presumed to be <spanx style="verb">null</spanx> (i.e. floating time).
</t>
<t>Corresponds to the TZID part of the DTSTART property in iCalendar.
</t>
</section>

<section anchor="duration-1" title="duration">
<t>Type: <spanx style="verb">Duration</spanx>, e.g. <spanx style="verb">P2DT3H</spanx> (Defaults to <spanx style="verb">P0D</spanx> if omitted)
</t>
<t>The duration of the event in absolute time (i.e. in UTC time; ignoring DST shifts). To get the end date in the event time zone, convert start into UTC, then apply the duration, then convert the result into the appropriate time zone.
</t>
<t>If <spanx style="emph">isAllDay</spanx> is <spanx style="verb">true</spanx>, then the following restrictions apply:
</t>
<t>
<list style="symbols">
<t>the <spanx style="emph">start</spanx> property MUST have a time component of <spanx style="verb">T00:00:00</spanx>.</t>
<t>the <spanx style="emph">timeZone</spanx> property MUST be <spanx style="verb">null</spanx> (or omitted).</t>
<t>the <spanx style="emph">duration</spanx> MUST only include a day component.</t>
</list>
</t>
<t>Corresponds to the DURATION or DSTART+DTEND properties in iCalendar.
</t>
</section>

<section anchor="recurrencerule" title="recurrenceRule">
<t>Type: <spanx style="verb">Recurrence|null</spanx>
</t>
<t>A recurrence rule for the event.
</t>
<t>Corresponds to the RRULE property in iCalendar.
</t>
<t>A <spanx style="strong">Recurrence</spanx> object is a JSON object mapping of a RECUR value type in iCalendar. A Recurrence object has the following properties:
</t>
<t>
<list style="symbols">
<t><spanx style="strong">frequency</spanx>: <spanx style="verb">String</spanx>
This MUST be one of the following values:
<list style="symbols">
<t><spanx style="verb">"yearly"</spanx></t>
<t><spanx style="verb">"monthly"</spanx></t>
<t><spanx style="verb">"weekly"</spanx></t>
<t><spanx style="verb">"daily"</spanx></t>
<t><spanx style="verb">"hourly"</spanx></t>
<t><spanx style="verb">"minutely"</spanx></t>
<t><spanx style="verb">"secondly"</spanx>
To convert from iCal, simply lower-case the FREQ part.</t>
</list></t>
<t><spanx style="strong">interval</spanx>: <spanx style="verb">Number</spanx> (optional, defaults to <spanx style="verb">1</spanx>)
The INTERVAL part from iCal. If included, it MUST be an integer <spanx style="verb">x &gt;= 1</spanx>.</t>
<t><spanx style="strong">rscale</spanx>: <spanx style="verb">String</spanx> (optional, defaults to <spanx style="verb">"gregorian"</spanx>)
The RSCALE part from iCal RSCALE (<xref target="RFC7529"/>), converted to lower-case.</t>
<t><spanx style="strong">skip</spanx>: <spanx style="verb">String</spanx> (optional, defaults to <spanx style="verb">"omit"</spanx>)
The SKIP part from iCal RSCALE (<xref target="RFC7529"/>), converted to lower-case.</t>
<t><spanx style="strong">firstDayOfWeek</spanx>: <spanx style="verb">String</spanx> (optional, defaults to <spanx style="verb">"monday"</spanx>)
The WKST part from iCal, represented as a lower-case two-letter English day of the week. If included, it MUST be one of the following values: <spanx style="verb">"mo"|"tu"|"we"|"th"|"fr"|"sa"|"su"</spanx></t>
<t><spanx style="strong">byDay</spanx>: <spanx style="verb">NDay[]</spanx> (optional)
The BYDAY part from iCal. The array MUST have at least one entry if included.
An <spanx style="strong">NDay</spanx> object has the following properties:
<list style="symbols">
<t><spanx style="strong">day</spanx>: <spanx style="verb">String</spanx>
The day-of-the-week part of the BYDAY value in iCal, lower-cased. MUST be one of the following values: <spanx style="verb">"mo"|"tu"|"we"|"th"|"fr"|"sa"|"su"</spanx>.</t>
<t><spanx style="strong">nthOfPeriod</spanx>: <spanx style="verb">Number</spanx> (optional)
If present, rather than representing <spanx style="emph">every</spanx> Friday (for example), it represents only a specific instance within the period (month for monthly recurrences, year for yearly recurrences). Must be a non-zero integer, negative integers means nth-last of period. This is the <spanx style="verb">"+1"</spanx> or <spanx style="verb">"-3"</spanx> etc. prefix from the BYDAY values in iCal.</t>
</list></t>
<t><spanx style="strong">byDate</spanx>: <spanx style="verb">Number[]</spanx> (optional)
The BYMONTHDAY part from iCal. The array MUST have at least one entry if included.</t>
<t><spanx style="strong">byMonth</spanx>: <spanx style="verb">String[]</spanx> (optional)
The BYMONTH part from iCal. Each entry is a string representation of a number, starting from &quot;1&quot; for the first month in the calendar (e.g. &quot;1&quot; means &quot;January&quot; with Gregorian calendar), with an optional &quot;L&quot; suffix for leap months (this MUST be upper-case, e.g. &quot;3L&quot;). The array MUST have at least one entry if included.</t>
<t><spanx style="strong">byYearDay</spanx>: <spanx style="verb">Number[]</spanx> (optional)
The BYYEARDAY part from iCal. The array MUST have at least one entry if included.</t>
<t><spanx style="strong">byWeekNo</spanx>: <spanx style="verb">Number[]</spanx> (optional)
The BYWEEKNO part from iCal. The array MUST have at least one entry if included.</t>
<t><spanx style="strong">byHour</spanx>: <spanx style="verb">Number[]</spanx> (optional)
The BYHOUR part from iCal. The array MUST have at least one entry if included.</t>
<t><spanx style="strong">byMinute</spanx>: <spanx style="verb">Number[]</spanx> (optional)
The BYMINUTE part from iCal. The array MUST have at least one entry if included.</t>
<t><spanx style="strong">bySecond</spanx>: <spanx style="verb">Number[]</spanx> (optional)
The BYSECOND part from iCal. The array MUST have at least one entry if included.</t>
<t><spanx style="strong">bySetPosition</spanx>: <spanx style="verb">Number[]</spanx> (optional)
The BYSETPOS part from iCal. The array MUST have at least one entry if included.</t>
<t><spanx style="strong">count</spanx>: <spanx style="verb">Number</spanx> (optional)
The COUNT part from iCal. This MUST NOT be included if an <spanx style="emph">until</spanx> property is specified.</t>
<t><spanx style="strong">until</spanx>: <spanx style="verb">LocalDate</spanx> (optional)
The UNTIL part from iCal. This MUST NOT be included if a <spanx style="emph">count</spanx> property is specified. Note, as in iCal, this date is presumed to be in the timezone specified in <spanx style="emph">timeZone</spanx>. It is not a UTC time.</t>
</list>
</t>
</section>

<section anchor="recurrenceoverrides" title="recurrenceOverrides">
<t>Type: <spanx style="verb">LocalDate[PatchObject|null]|null</spanx>
</t>
<t>The object is a map of the Recurrence-Id (i.e. the date-time of the start of the occurrence) to either <spanx style="verb">null</spanx>, to indicate the occurrence should be deleted, or an object of patches to apply to the generated Event occurrence object.
</t>
<t>If the Recurrence-Id does not match an expanded start date from a recurrence rule, it is to be treated as an additional occurrence (like an RDATE from iCalendar). The patch object may often be empty in this case.
</t>
<t>By default, an occurrence inherits all properties from the main event except the <spanx style="emph">start</spanx> date-time, which is shifted to the new start time. However, individual properties of the occurrence can be modified by a patch, or multiple patches.
</t>
<t>A <spanx style="strong">PatchObject</spanx> is of type <spanx style="verb">String[*|null]</spanx>, and represents an unordered set of patches to apply to the generated occurrence Event object.
</t>
<t>The keys are a path in a subset of <xref target="RFC6901"/> JSON pointer format, with an implicit leading <spanx style="verb">/</spanx> (i.e. prefix each key with <spanx style="verb">/</spanx> before applying the JSON pointer evaluation algorithm).
</t>
<t>A pointer MUST NOT start with one of the following prefixes; any patch with a such a key MUST be ignored:
</t>
<t>
<list style="symbols">
<t><spanx style="verb">uid</spanx></t>
<t><spanx style="verb">relatedTo</spanx></t>
<t><spanx style="verb">prodId</spanx></t>
<t><spanx style="verb">method</spanx></t>
<t><spanx style="verb">isAllDay</spanx></t>
<t><spanx style="verb">recurrenceRule</spanx></t>
<t><spanx style="verb">recurrenceOverrides</spanx></t>
<t><spanx style="verb">replyTo</spanx></t>
</list>
</t>
<t>The pointer MUST NOT reference inside an array (i.e. you MUST NOT insert/delete from an array; the array MUST be replaced in its entirety instead). Any patch with a key that attempts to do this MUST be ignored.
</t>
<t>When evaluating a path, all parts prior to the last (i.e. the value after the final slash) MUST exist for the patch to be valid. If not, the patch MUST be ignored.
</t>
<t>There MUST NOT be two patches in the PatchObject where the pointer of one is the prefix of the pointer of the other, e.g. <spanx style="verb">alerts/1/offset</spanx> AND <spanx style="verb">alerts</spanx>. The result in this case is undefined.
</t>
<t>The value associated with each pointer is either:
</t>
<t>
<list style="symbols">
<t><spanx style="verb">null</spanx>: Remove the property. If not present in the parent, this a no-op.</t>
<t>Anything else: The value to replace the inherited property on the occurrence with (if present) or add to the occurrence (if not present).</t>
</list>
</t>
<t>Corresponds to the RDATE and EXDATE properties in iCalendar, plus VEVENT instances with a Recurrence-Id.
</t>
</section>
</section>

<section anchor="scheduling-properties" title="Scheduling properties">

<section anchor="status" title="status">
<t>Type: <spanx style="verb">String</spanx> (Defaults to <spanx style="verb">confirmed</spanx> if omitted)
</t>
<t>The status of the event. MUST be one of:
</t>
<t>
<list style="symbols">
<t><spanx style="verb">"confirmed"</spanx>: Indicates event is definite</t>
<t><spanx style="verb">"cancelled"</spanx>: Indicates event was cancelled.</t>
<t><spanx style="verb">"tentative"</spanx>: Indicates event is tentative.</t>
</list>
</t>
<t>Corresponds to the STATUS property in iCalendar (converted to lower-case).
</t>
</section>

<section anchor="showasfree" title="showAsFree">
<t>Type: <spanx style="verb">Boolean</spanx> (Defaults to <spanx style="verb">false</spanx> if omitted)
</t>
<t>If true, the event should be ignored when calculating free/busy data for the user.
</t>
<t>Corresponds to the TRANSP property in iCalendar.
</t>
</section>

<section anchor="replyto" title="replyTo">
<t>Type: <spanx style="verb">String[String]|null</spanx>
</t>
<t>Represents methods by which a participant may RSVP to the organizer of the event. The keys in the object are the available methods. The value is a uri to use that method. Future methods may be defined in future specications; a calendar client MUST just ignore any method it does not understand.
</t>
<t>The following methods are defined:
</t>
<t>
<list style="symbols">
<t><spanx style="verb">imip</spanx>: The organizer accepts an iMIP (<xref target="RFC6047"/>) response. The value MUST be a <spanx style="verb">mailto:</spanx> uri. Corresponds to the email address of the ORGANIZER property in iCalendar.</t>
<t><spanx style="verb">web</spanx>: There is a web page where the user may submit an RSVP using their browser. The value MUST be an <spanx style="verb">http:</spanx> or <spanx style="verb">https:</spanx> uri. There is no standard representation of this in iCalendar.</t>
</list>
</t>
</section>

<section anchor="participants" title="participants">
<t>Type: <spanx style="verb">String[Participant]|null</spanx>
</t>
<t>A map of participant id to an object describing their participation in the event. A participant id may be any string and need only be unique to this event; the email address of the participant is a good choice.
</t>
<t>Corresponds to the ORGANIZER and ATTENDEES properties from iCalendar.
</t>
<t>A <spanx style="strong">Participant</spanx> object has the following properties. Properties are mandatory unless marked otherwise:
</t>
<t>
<list style="symbols">
<t><spanx style="strong">name</spanx>: <spanx style="verb">String</spanx>
The display name of the participant (e.g. &quot;Joe Bloggs&quot;).
Corresponds to the CN parameter in iCalendar.</t>
<t><spanx style="strong">email</spanx>: <spanx style="verb">String</spanx>
The email address for the participant.</t>
<t><spanx style="strong">kind</spanx>: <spanx style="verb">String</spanx> (optional, defaults to &quot;unknown&quot;)
What kind of entity this participant is. This MUST be either one of the following values, registered in a future RFC, or a vendor-specific value. Vendor specific values MUST be prefixed with a domain name controlled by the vendor, e.g. <spanx style="verb">fastmail.com/specialkind</spanx>. Any value the client or server doesn't understand should be treated the same as <spanx style="verb">unknown</spanx>.
<list style="symbols">
<t><spanx style="verb">individual</spanx>: a single person</t>
<t><spanx style="verb">group</spanx>: a collection of people invited as a whole</t>
<t><spanx style="verb">resource</spanx>: a non-human resource, e.g. a projector</t>
<t><spanx style="verb">location</spanx>: a physical location involved in the event that needs to be scheduled, e.g. a conference room.</t>
<t><spanx style="verb">unknown</spanx>: no information is available about the kind of this participant.</t>
</list></t>
</list>
</t>
<t>Corresponds to the CUTYPE parameter in iCalendar.
</t>
<t>
<list style="symbols">
<t><spanx style="strong">roles</spanx>: <spanx style="verb">String[]</spanx>
A list of roles that this participant fulfils. At least one value MUST be specified for the participant. This MUST be either one of the following values, registered in a future RFC, or a vendor-specific value. Vendor specific values MUST be prefixed with a domain name controlled by the vendor, e.g. <spanx style="verb">fastmail.com/specialkind</spanx>. Any value the client or server doesn't understand should be preserved but ignored.
<list style="symbols">
<t><spanx style="verb">owner</spanx>: The participant is an organizer of the event, and allowed to make alterations to any part of the event.</t>
<t><spanx style="verb">attendee</spanx>: The participant is an attendee of the event.</t>
<t><spanx style="verb">chair</spanx>: The participant is in charge of the event when it occurs.</t>
</list></t>
<t><spanx style="strong">locationId</spanx>: <spanx style="verb">String|null</spanx> (optional, defaults to <spanx style="verb">null</spanx>)
The location at which this person is expected to be attending this event.
If the value does not correspond to any location id in the <spanx style="emph">locations</spanx>
property of the instance, this MUST be treated the same as if the
participant's <spanx style="emph">locationId</spanx> were specified as <spanx style="verb">null</spanx>.</t>
<t><spanx style="strong">scheduleStatus</spanx>: <spanx style="verb">String</spanx> (optional, defaults to 'needs-action')
The value MUST be one of the following, or defined in a future RFC or extension to iCalendar:
<list style="symbols">
<t><spanx style="verb">needs-action</spanx>: No status yet set by the participant.</t>
<t><spanx style="verb">accepted</spanx>: The participant will attend the event.</t>
<t><spanx style="verb">declined</spanx>: The participant may attend the event.</t>
<t><spanx style="verb">tentative</spanx>: The participant will not attend the event.</t>
</list>
Corresponds to the PARTSTAT parameter in iCalendar (converted to lower case).</t>
<t><spanx style="strong">schedulePriority</spanx>: <spanx style="verb">String</spanx> (optional, defaults to &quot;required&quot;)
Thev value MUST be either one of the following values, registered in a future RFC, or a vendor-specific value. Vendor specific values MUST be prefixed with a domain name controlled by the vendor, e.g. <spanx style="verb">fastmail.com/specialkind</spanx>. Any value the client or server doesn't understand should be treated the same as <spanx style="verb">required</spanx>.
<list style="symbols">
<t><spanx style="verb">non-participant</spanx>: Indicates a participant who is copied for information purposes only.</t>
<t><spanx style="verb">optional</spanx>: Indicates a participant whose participation is optional.</t>
<t><spanx style="verb">required</spanx>: Indicates a participant whose participation is required.</t>
</list>
Corresponds to the ROLE parameter in iCalendar.</t>
<t><spanx style="strong">scheduleRSVP</spanx>: <spanx style="verb">Boolean</spanx> (optional, defaults to <spanx style="verb">false</spanx>)
If <spanx style="verb">true</spanx>, the organizer is expecting the participant to notify them of their status.
Corresponds to the RSVP parameter in iCalendar.</t>
<t><spanx style="strong">scheduleUpdated</spanx>: <spanx style="verb">UTCDate|null</spanx> (optional, defaults to <spanx style="verb">null</spanx>)
The <spanx style="emph">updated</spanx> property of the last response from the user. This can be
compared to the <spanx style="emph">updated</spanx> timestamp in future iMIP responses to determine
if the response is older or newer than the current data.
Corresponds to the DTSTAMP parameter in iCalendar.</t>
<t><spanx style="strong">memberOf</spanx>: <spanx style="verb">String[]</spanx> (optional)
A list of group addresses that were invited to this event, which caused this participant to be invited due to their membership of the group(s). This MUST be omitted if none (rather than an empty array).</t>
</list>
</t>
</section>
</section>

<section anchor="alerts-properties" title="Alerts properties">

<section anchor="usedefaultalerts" title="useDefaultAlerts">
<t>Type: <spanx style="verb">Boolean</spanx> (Defaults to <spanx style="verb">false</spanx> if omitted)
</t>
<t>If <spanx style="verb">true</spanx>, use the user's default alerts for this event and ignore the
<spanx style="emph">alerts</spanx> property. Fetching user defaults is dependent on the API from which
this object is being fetched, and is not defined in this specification.
</t>
</section>

<section anchor="alerts" title="alerts">
<t>Type: <spanx style="verb">String[Alert]|null</spanx>
</t>
<t>A map of of alert id to Alert objects, representing alerts/reminders to display or send the user for this event. An alert id may be any string and need only be unique to this event, although a UUID is a practical choice.
</t>
<t>Corresponds to the VALARM component in iCalendar.
</t>
<t>An <spanx style="strong">Alert</spanx> Object has the following properties:
</t>
<t>
<list style="symbols">
<t><spanx style="strong">relativeTo</spanx>: <spanx style="verb">String</spanx> (optional, defaults to <spanx style="verb">"before-start"</spanx>)
This specifies where the offset is relative to for the alarm to trigger.
The value MUST be one of:
<list style="symbols">
<t><spanx style="verb">"before-start"</spanx></t>
<t><spanx style="verb">"after-start"</spanx></t>
<t><spanx style="verb">"before-end"</spanx></t>
<t><spanx style="verb">"after-end"</spanx></t>
</list></t>
<t><spanx style="strong">offset</spanx>: <spanx style="verb">Duration</spanx>
The offset from the start/end of the event to fire the alert. Note, if the event is in floating time (including all-day events), the server SHOULD use the user's default time zone when determining the start time.</t>
<t><spanx style="strong">action</spanx>: <spanx style="verb">DisplayAction|EmailAction|UnknownAction</spanx>
How to alert the user. A <spanx style="emph">DisplayAction</spanx> means a message (which is service dependent, but SHOULD include the summary and start time of the event) SHOULD be shown to the user on any client connected to this account at the specified time. How this message is formatted (and any sound or other method of drawing the user's attention) is client specific. An <spanx style="emph">EmailAction</spanx> means the server MUST send an email as specified in the object at the specified time.
Where a <spanx style="strong">DisplayAction</spanx> object has the following properties:
<list style="symbols">
<t><spanx style="strong">type</spanx>: <spanx style="verb">String</spanx>
The value MUST be <spanx style="verb">"display"</spanx>.</t>
<t><spanx style="strong">acknowledged</spanx>: <spanx style="verb">UTCDate|null</spanx>
When the user has permanently dismissed the alert the client SHOULD set this to the current time in UTC. Other clients which sync this property can then automatically dismiss or suppress duplicate alerts (alerts with the same alert id that triggered on or before this date-time). For a recurring event, the <spanx style="emph">acknowledged</spanx> property of the parent event SHOULD be updated, unless the alert is already overriden in <spanx style="emph">recurrenceOverrides</spanx>.</t>
<t><spanx style="strong">snoozed</spanx>: <spanx style="verb">UTCDate|null</spanx>
If the user temporarily dismisses the alert, this is the UTC date-time
after which it should be reshown.</t>
</list>
Clients displaying this alert SHOULD hide it if the <spanx style="emph">snoozed</spanx> property is updated to a time in the future. When that time is reached, the alert SHOULD be reshown unless <spanx style="emph">acknowledged</spanx> is now after the <spanx style="strong">original</spanx> trigger time.
Where an <spanx style="strong">EmailAction</spanx> object has the following properties:
<list style="symbols">
<t><spanx style="strong">type</spanx>: <spanx style="verb">String</spanx>
The value MUST be <spanx style="verb">"email"</spanx>.</t>
<t><spanx style="strong">to</spanx>: <spanx style="verb">Emailer[]</spanx>
An array of name/email objects to send the alert to. An <spanx style="strong">Emailer</spanx> object has the following properties:
<list style="symbols">
<t><spanx style="strong">name</spanx>: <spanx style="verb">String</spanx>
The name of the recipient. If not known, clients SHOULD use the empty string.</t>
<t><spanx style="strong">email</spanx>: <spanx style="verb">String</spanx>
The email address of the recipient.</t>
</list></t>
<t><spanx style="strong">subject</spanx>: <spanx style="verb">String</spanx> (optional)
The subject to use for the email. If omitted, this is implementation specific, but the server SHOULD try to choose an appropriate subject (such as &quot;Event Summary: starting in 5 min&quot;).</t>
<t><spanx style="strong">textBody</spanx>: <spanx style="verb">String</spanx> (optional)
The plain-text body to use for the email. If omitted, the body of the email is implementation specific, but the server SHOULD include all pertinent details about the event, such as summary, location and start time.</t>
</list>
An <spanx style="strong">UnknownAction</spanx> object is an object that contains a <spanx style="verb">type</spanx> property whose value is not <spanx style="verb">"email"</spanx> or <spanx style="verb">"string"</spanx>, plus zero or more other properties. This is for compatibility with client extensions and future RFCs. The client or server SHOULD NOT trigger any type of alert for action types they do not understand, but MUST preserve them.</t>
</list>
</t>
</section>
</section>

<section anchor="security-considerations" title="Security Considerations">
<t>The use of JSON as a format does have its own inherent security risks as discussed in Section 12 of <xref target="RFC7159"/>. Even though JSON is considered a safe subset of JavaScript, it should be kept in mind that a flaw in the parser processing JSON could still impose a threat, which doesn't arise with conventional iCalendar data.
</t>
<t>With this in mind, a parser for JSON data aware of the security implications should be used for the format described in this document. For example, the use of JavaScript's <spanx style="verb">eval()</spanx> function is considered an unacceptable security risk, as described in Section 12 of <xref target="RFC7159"/>. A native parser with full awareness of the JSON format should be preferred.
</t>
</section>

<section anchor="iana-considerations" title="IANA Considerations">
<t>This document defines a MIME media type for use with iCalendar in JSON
data. This media type SHOULD be used for the transfer of calendaring
data in JSON.
</t>
</section>

<section anchor="acknowledgments" title="Acknowledgments">
<t>The author would like to thank the following for their valuable contributions: (TODO:names). This specification originated from the work of the API technical committee of CalConnect, the Calendaring and Scheduling Consortium.
</t>
</section>

</middle>
<back>
<references title="Normative References">
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3339.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5545.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5646.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5870.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5988.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6047.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6901.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7159.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7493.xml"?>
<?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7529.xml"?>
</references>

</back>
</rfc>
